\documentclass{ximera}
\input{../preamble.tex}

\title{Least-Squares Approximation} \license{CC BY-NC-SA 4.0}

\begin{document}

\begin{abstract}
\end{abstract}
\maketitle

\begin{onlineOnly}
\section*{Least-Squares Approximation}
\end{onlineOnly}

\begin{center}
\begin{tikzpicture}[scale=1]
  \filldraw[orange](-0.25,3.5)--(0.25,3.5)--(1.5,0)--(-1.5,0)--cycle;
  \filldraw[orange] (0,0) ellipse (2cm and 1cm);
  \filldraw[orange] (0,3.5) ellipse (0.25cm and 0.15cm);
\end{tikzpicture}
 
UNDER CONSTRUCTION -- COMING SOON
\end{center}

Often an exact solution to a problem in applied mathematics is difficult or impossible to obtain. However, it is usually just as useful to find an approximation to a solution. In particular, finding ``linear approximations" is a potent technique in applied mathematics. One basic case is the situation where a system
of linear equations has no solution, and it is desirable to find a ``best approximation" to a solution to the
system. In this section best approximations are defined and a method for finding them is described. 

\begin{exploration}\label{exp:leastSq1}
    Let
    $$A=\begin{bmatrix}3 & 1\\1 & 2\\1 & 2\end{bmatrix};\quad\text{and}\quad \vec{b}=\begin{bmatrix}2\\1\\3\end{bmatrix}$$
    Consider the matrix equation $A\vec{x}=\vec{b}$.
    A quick examination of the last two rows should convince you that this equation has no solutions.  In other words, $\vec{b}$ is not in the span of the columns of $A$.

    We will attempt to find the next best thing to a solution to $A\vec{x}=\vec{b}$ by finding $\vec{z}$ such that $\norm{\vec{b}-A\vec{z}}$ is as small as possible.  

    The following GeoGebra interactive will help you understand the geometry behind finding $\vec{z}$.  RIGHT-CLICK and DRAG to rotate the image for a better view.

\begin{onlineOnly}
\begin{center}
\geogebra{mm7wauhw}{950}{650}
\end{center}
\end{onlineOnly}
\end{exploration}


\begin{center}
\tdplotsetmaincoords{70}{130}
\begin{tikzpicture}

    \draw[line width=2pt,blue](-3,1,1)--(5,6,5);
    
    \draw[line width=0.5pt, dashed, gray](-3,1,1)--(5,1,1);
    \draw[line width=0.5pt, dashed, gray](5,1,1)--(5,1,5);
    \draw[line width=0.5pt, dashed, gray](5,1,1)--(5,6,1);
    \draw[line width=0.5pt, dashed, gray](5,6,5)--(5,6,1);
    \draw[line width=0.5pt, dashed, gray](-3,6,1)--(5,6,1);
    \draw[line width=0.5pt, dashed, gray](-3,6,1)--(-3,6,5);
    \draw[line width=0.5pt, dashed, gray](-3,6,1)--(-3,1,1);
    \draw[line width=0.5pt, dashed, gray](-3,6,5)--(-3,1,5);
    \draw[line width=0.5pt, dashed, gray](-3,6,5)--(5,6,5);
    
    
    \draw[line width=1pt,red, dashed, -stealth](5,1,5)--(5,5.8,5);
    \draw[line width=1pt,red, dashed, -stealth](-3,1,5)--(4.9,1,5);
     \draw[line width=1pt,red, dashed,-stealth](-3,1,1)--(-3,1,4.8);
     
    
    \fill[red] (-3,1,1) node[above left]{$(1,-3,1)$} circle (0.1cm); 
    \fill[red] (5,6,5) node[above left]{$(5,5,6)$} circle (0.1cm);
    
    \node[red] at (0.8, 1.3, 5)   {over $8$};
    \node[red] at (-2.1, 1.3, 3.6)   {out $4$};
    \node[red] at (5.1, 3, 4)   {up $5$};
    
\end{tikzpicture}
\end{center}

\begin{center}
\tdplotsetmaincoords{70}{130}
\begin{tikzpicture}[scale=0.5]
   \filldraw[blue, opacity=0.3](0,0,2)--(0,2,2)--(0,2,-2)--(0,0,-2)--cycle;
   \filldraw[red, opacity=0.3] (2,0,2)--(0,0,2)--(0,0,-2)--(2,0,-2)--cycle;
   \filldraw[gray, opacity=0.5] (0,2,2)--(0,2,-2)--(2,0,-2)--(2,0,2)--cycle;
\end{tikzpicture}
\end{center}










This is from Nicholson's section on QR, and may be helpful:

In Section~\ref{sec:5_6} we found how to find a best approximation $\vec{z}$ to a solution of a (possibly inconsistent) system $A\vec{x} = \vec{b}$ of linear equations: take $\vec{z}$ to be any solution of the ``normal'' equations $(A^{T}A)\vec{z} = A^{T}\vec{b}$. If $A$ has independent columns this $\vec{z}$ is unique ($A^{T}A$ is invertible by Theorem~\ref{thm:015672}), so it is often desirable to compute $(A^{T}A)^{-1}$. This is particularly useful in least squares approximation (Section~\ref{sec:5_6}). This is simplified if we have a QR-factorization of $A$ (and is one of the main reasons for the importance of Theorem~\ref{th:QR-025133}). For if $A = QR$ is such a factorization, then $Q^{T}Q = I_{n}$ because $Q$ has orthonormal columns (verify), so we obtain
\begin{equation*}
A^TA = R^TQ^TQR = R^TR
\end{equation*}
Hence computing $(A^{T}A)^{-1}$ amounts to finding $R^{-1}$, and this is a routine matter because $R$ is upper triangular. Thus the difficulty in computing $(A^{T}A)^{-1}$ lies in obtaining the QR-factorization of $A$.

\end{document}